<!DOCTYPE html>
<html lang="ja" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <h1>Hands Free Presentation</h1>
    <form id="form1">
      <input type="file"  action=".pptx" id="file1"/>
      <input type="submit" value="送信"/>
    </form>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script language="javascript" type="text/javascript">
      //pptxファイルを選択するダイアログを開く
      $("#open").on("click", () => {
        $("#file1").click();
        return false;
      });

      //ファイルを一つ選択
      $("#form1").on("submit",() => {
        const files = $("#file1")[0].files;

        //ファイルが選択されていない時は、何もせずに終了
        if(files.length === 0) {
          return  false;
        }

        //選択したpptxファイルを取得
        const file = files[0];

        //ファイル名表示
        const filename = file.name;
        console.log(`選択されたファイル名:${filename}`);

        //キャンセルの場合
        return false;
      });
      //開発中にメンターさんから頂いたコメント（メモ）
      //ODPを表示できるJSライブラリーでhttps://github.com/webodf/ViewerJS
      //があるんですが、こういうpptxの前にodp（ここはpdfも表示できそう)をpptxの前に試しに動きなどを求めてるものと同じか
      //確認してみたりするのはありかなぁと思いました。
      //ただ一般論としてpptxを自力でレンダリングするのは相当手間だと思うので
      //その前にいわゆるビューワーとして提供されているライブラリーなどを使えるようになる。使ってみて自分がしたいことができてる場合は、次のビューワーの操作の部分を自分でコントロールできるようにする
      //次にコントロールする手段でキーボードなどのインターフェース以外に音声を受け付けれるようにし、音声からビューワーを操作できるようにする。
      //粒度が荒いですが、これぐらいのステップを踏んで見た方がやりたいことに近づけると思いますー

    </script>
    <p>ユーザーがプレゼンに使うスライドと声を登録する画面</p>
    <!-- この結果はapp/controllers/presentations_controller.rbに渡される -->
    <%= form_for Presentation.new do |f| %>
      <%= f.label :name %>
      <%= f.text_field :title %>
      <%= f.label :content %>
      <%= f.text_area :content %>
      <%= f.submit %>
    <% end %>
    <p>Find me in app/views/presentations/new.html.erb</p>
  </body>
</html>
